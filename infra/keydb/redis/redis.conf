# https://github.com/Snapchat/KeyDB/blob/unstable/keydb.conf
port {{ env "NOMAD_PORT_redis" }}

maxmemory {{ env "NOMAD_MEMORY_LIMIT" | parseInt | subtract 16 }}mb

dir /data

# tls
# tls-cert-file /secrets/certs/cert.pem
# tls-key-file /secrets/certs/key.pem
# tls-ca-cert-file /secrets/certs/CA.pem
# tls-auth-clients yes
# tls-replication yes

stop-writes-on-bgsave-error no
dbfilename dump.rdb

include /secrets/auth.conf

# keydb options
server-threads 2
active-replica yes
